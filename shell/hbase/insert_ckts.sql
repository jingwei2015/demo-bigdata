set hive.auto.convert.join=false;
insert into dw.dw_hbase_nsr
select nsr.rowkey rowkey,map() nsrxx,
map() nsrkz,
map() nsrrd,
map('code',COALESCE(cp.code,''),'aux_index',COALESCE(cp.aux_index,''),'name',COALESCE(cp.name,''),'jsjdj_no',COALESCE(cp.jsjdj_no,''),'nsrdj_no',COALESCE(cp.nsrdj_no,''),'lsgx',COALESCE(cp.lsgx,''),'gsl_set',COALESCE(cp.gsl_set,''),'qylx',COALESCE(cp.qylx,''),'js_mode',COALESCE(cp.js_mode,''),'jl_mode',COALESCE(cp.jl_mode,''),'sbfs',COALESCE(cp.sbfs,''),'fbhs',COALESCE(cp.fbhs,''),'dpcd_set',COALESCE(cp.dpcd_set,''),'ts_grade',COALESCE(cp.ts_grade,'0'),'ts_state',COALESCE(cp.ts_state,''),'sbck_date',COALESCE(cast(cp.sbck_date as string),''),'fullname',COALESCE(cp.fullname,''),'tsdjz_no',COALESCE(cp.tsdjz_no,''),'tsdjz_fzrq',COALESCE(cast(cp.tsdjz_fzrq as string),''),'address',COALESCE(cp.address,''),'zs',COALESCE(cp.zs,''),'jycsyw',COALESCE(cp.jycsyw,''),'postcode',COALESCE(cp.postcode,''),'jyzywm',COALESCE(cp.jyzywm,''),'tel',COALESCE(cp.tel,''),'tel2',COALESCE(cp.tel2,''),'fax',COALESCE(cp.fax,''),'email',COALESCE(cp.email,''),'nsrlb',COALESCE(cp.nsrlb,''),'swcode',COALESCE(cp.swcode,''),'tsswcode',COALESCE(cp.tsswcode,''),'zclxcode',COALESCE(cp.zclxcode,''),'hycode',COALESCE(cp.hycode,''),'ysjccode',COALESCE(cp.ysjccode,''),'zzsbfs',COALESCE(cp.zzsbfs,''),'jckq_pwh',COALESCE(cp.jckq_pwh,''),'jyfw',COALESCE(cp.jyfw,''),'gsdjz_no',COALESCE(cp.gsdjz_no,''),'gsdjz_fzrq',COALESCE(cast(cp.gsdjz_fzrq as string),''),'gsdjz_yxq',COALESCE(cp.gsdjz_yxq,'0'),'qyfr',COALESCE(cp.qyfr,''),'qyfr_zw',COALESCE(cp.qyfr_zw,''),'cwfzr',COALESCE(cp.cwfzr,''),'bsy',COALESCE(cp.bsy,''),'bsy2',COALESCE(cp.bsy2,''),'bsy_tel',COALESCE(cp.bsy_tel,''),'bsy_bp',COALESCE(cp.bsy_bp,''),'jyzlx',COALESCE(cp.jyzlx,''),'zczj',COALESCE(cp.zczj,''),'nsxydj',COALESCE(cp.nsxydj,''),'bkname',COALESCE(cp.bkname,''),'acc_no',COALESCE(cp.acc_no,''),'thjc',COALESCE(cp.thjc,''),'tkjc',COALESCE(cp.tkjc,''),'zgwgj',COALESCE(cp.zgwgj,''),'wgjcode',COALESCE(cp.wgjcode,''),'bgqk',COALESCE(cp.bgqk,''),'cwgg',COALESCE(cp.cwgg,'0'),'zssl',COALESCE(cp.zssl,''),'fbqk',COALESCE(cp.fbqk,''),'flglcd',COALESCE(cp.flglcd,''),'tsglsm',COALESCE(cp.tsglsm,''),'nsrztcode',COALESCE(cp.nsrztcode,''),'sh_cfg',COALESCE(cp.sh_cfg,''),'zgycode',COALESCE(cp.zgycode,''),'xxqy',COALESCE(cp.xxqy,''),'wshx',COALESCE(cp.wshx,''),'wshx_st_date',COALESCE(cast(cp.wshx_st_date as string),''),'wshx_end_date',COALESCE(cast(cp.wshx_end_date as string),''),'user_group',COALESCE(cp.user_group,''),'ccode',COALESCE(cp.ccode,''),'note',COALESCE(cp.note,''),'bbtj',COALESCE(cp.bbtj,''),'flag',COALESCE(cp.flag,''),'exp_c',COALESCE(cp.exp_c,''),'exp_n',COALESCE(cp.exp_n,'0'),'rsv_flag',COALESCE(cp.rsv_flag,''),'op_user',COALESCE(cp.op_user,''),'op_date',COALESCE(cast(cp.op_date as string),''),'bgd_mth',COALESCE(cp.bgd_mth,'0'),'yqshts',COALESCE(cp.yqshts,'0'),'zx_flag',COALESCE(cp.zx_flag,''),'zx_date',COALESCE(cast(cp.zx_date as string),''),'zx_reason',COALESCE(cp.zx_reason,''),'yzssl',COALESCE(cp.yzssl,''),'kjmy',COALESCE(cp.kjmy,''),'flglcd_wg',COALESCE(cp.flglcd_wg,''),'cnt_flag',COALESCE(cp.cnt_flag,''),'lsl_flag',COALESCE(cp.lsl_flag,''),'lsl_sb_date',COALESCE(cast(cp.lsl_sb_date as string),''),'jy_address',COALESCE(cp.jy_address,''),'jylxcode',COALESCE(cp.jylxcode,''),'ysfw',COALESCE(cp.ysfw,''),'ysfwcode',COALESCE(cp.ysfwcode,''),'qyfr_no',COALESCE(cp.qyfr_no,''),'qyfr_tel',COALESCE(cp.qyfr_tel,''),'bsy_no',COALESCE(cp.bsy_no,''),'bsy2_no',COALESCE(cp.bsy2_no,''),'bsy2_tel',COALESCE(cp.bsy2_tel,''),'yhzc',COALESCE(cp.yhzc,''),'fszl',COALESCE(cp.fszl,''),'sjdwsb',COALESCE(cp.sjdwsb,''),'ysfs',COALESCE(cp.ysfs,''),'gkcode',COALESCE(cp.gkcode,''),'yhzl_dm',COALESCE(cp.yhzl_dm,''),'yh_dm',COALESCE(cp.yh_dm,''),'zgy_name',COALESCE(cp.zgy_name,'')) ckts,
map() hy,
map() fppz,
map() swjg,
map() region,
from_unixtime(unix_timestamp(),'yyyy-MM-dd') czsj
from etl.etl_ckts cp join dw.dw_hbase_nsr nsr on  cp.nsrdj_no = nsr.rowkey;
set hive.auto.convert.join=true;