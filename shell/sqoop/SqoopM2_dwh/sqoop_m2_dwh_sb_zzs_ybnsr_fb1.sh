#!/bin/bash
#sql="select SB.NSRSBH, SB.NSRMC, SB.SKSSQQ, SB.SKSSQZ, SUM(KJQTFP_XSE) KJQTFP_XSE, SUM(KJQTFP_XXYNSE) KJQTFP_XXYNSE, SUM(WKJFP_XSE) WKJFP_XSE, SUM(WKJFP_XXYNSE) WKJFP_XXYNSE from HX_SB.SB_SBB SB LEFT JOIN HX_SB.SB_ZZS_YBNSR_FB1_BQXSQKMX MX ON MX.SBUUID = SB.SBUUID WHERE SB.YZPZZL_DM = 'BDA0610606' AND SB.SKSSQQ = to_date('$1','yyyy-MM-dd') AND SB.SKSSQZ = to_date('$2','yyyy-MM-dd') AND SB.ZFBZ_1 = 'N' AND SB.GZLX_DM_1 IN ('1', '5','4') AND EWBHXH BETWEEN 1 AND 19 AND \$CONDITIONS GROUP BY SB.NSRSBH, SB.NSRMC, SB.SKSSQQ, SB.SKSSQZ"

#sql="select SB.NSRSBH, SB.NSRMC, SB.SKSSQQ, SB.SKSSQZ, SUM(KJQTFP_XSE) KJQTFP_XSE, SUM(KJQTFP_XXYNSE) KJQTFP_XXYNSE, SUM(WKJFP_XSE) WKJFP_XSE, SUM(WKJFP_XXYNSE) WKJFP_XXYNSE from SB_SBB SB LEFT JOIN SB_ZZS_YBNSR_FB1_BQXSQKMX MX ON MX.SBUUID = SB.SBUUID WHERE SB.YZPZZL_DM = 'BDA0610606' AND SB.SKSSQQ = to_date('$1','yyyy-MM-dd') AND SB.SKSSQZ = to_date('$2','yyyy-MM-dd') AND SB.ZFBZ_1 = 'N' AND SB.GZLX_DM_1 IN ('1', '5','4') AND EWBHXH BETWEEN 1 AND 19 AND \$CONDITIONS GROUP BY SB.NSRSBH, SB.NSRMC, SB.SKSSQQ, SB.SKSSQZ"
sql="select SB.NSRSBH, SB.NSRMC, SB.SKSSQQ, SB.SKSSQZ, SUM(KJQTFP_XSE) KJQTFP_XSE, SUM(KJQTFP_XXYNSE) KJQTFP_XXYNSE, SUM(WKJFP_XSE) WKJFP_XSE, SUM(WKJFP_XXYNSE) WKJFP_XXYNSE from HX_SB.SB_SBB SB LEFT JOIN HX_SB.SB_ZZS_YBNSR_FB1_BQXSQKMX MX ON MX.SBUUID = SB.SBUUID WHERE SB.YZPZZL_DM = 'BDA0610606' AND SB.SKSSQQ = to_date('$1','yyyy-MM-dd') AND SB.ZFBZ_1 = 'N' AND SB.GZLX_DM_1 IN ('1', '5','4') AND EWBHXH BETWEEN 1 AND 19 AND \$CONDITIONS GROUP BY SB.NSRSBH, SB.NSRMC, SB.SKSSQQ, SB.SKSSQZ"

map=SKSSQQ=STRING,SKSSQZ=STRING,KJQTFP_XSE=DOUBLE,KJQTFP_XXYNSE=DOUBLE,WKJFP_XSE=DOUBLE,WKJFP_XXYNSE=DOUBLE
bash ${UtilPath}/SqoopJdbc_M2_dwh.sh ${m2_dwh_username} m2_dwh SB_ZZS_YBNSR_FB1 "$sql" $map
