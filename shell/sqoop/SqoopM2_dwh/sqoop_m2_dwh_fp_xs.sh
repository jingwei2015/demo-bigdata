#!/bin/bash
sql="select '' as NSRJC_CZXH,nvl(to_char(c.djxh), c.nsrsbh) as NSRDZDAH,b.FPZL_DM,b.FP_DM,b.FPSL as BS,b.FPQSHM as FPQH,b.FPZZHM as FPZH,'' as DJ,'' as JE,a.LRRQ as RQ,a.SFZJHM as ZJHM ,a.FPKF_DM as FPKF_DM ,a.SLR_DM as FPJBR ,SFZJLX_DM as FRZJLX_DM,'' as SPXLH,'' as JKPZXH,'' as GPTP_BZ,'' as WSPZXH,'' as ICKH,'' as GPXLTZ_WSPZXH,'' as PZZL_DM,'' as SPHM,a.LRR_DM as LRR_DM,a.LRRQ as LRRQ,a.XGR_DM as XGR_DM,a.XGRQ as XGRQ,a.ZGSWSKFJ_DM as SWJG_DM,a.ZGSWSKFJ_DM as NSR_SWJG_DM,'' as FPLB_BZ,'' as FPYSKLSH from hx_fp.fp_ly a,hx_fp.fp_ly_mx b ,hx_dj.dj_nsrxx c where a.fplyuuid = b.fplyuuid and c.djxh=a.djxh and a.lrrq between to_date('$1','yyyy-mm-dd') and to_date('$2 23:59:59','yyyy-mm-dd hh24:mi:ss') and \$CONDITIONS"
#map=BS=DOUBLE,LRRQ=STRING,XGRQ=STRING,RQ=STRING,NSRJC_CZXH=DOUBLE,NSRDZDAH=STRING,BS=DOUBLE,DJ=DOUBLE,JE=DOUBLE,RQ=DOUBLE,SPXLH=DOUBLE,JKPZXH=DOUBLE,WSPZXH=DOUBLE,GPXLTZ_WSPZXH=DOUBLE,LRRQ=DOUBLE,XGRQ=DOUBLE,FPYSKLSH=DOUBLE
bash ${UtilPath}/SqoopJdbc_M2_dwh.sh ${m2_dwh_username} m2_dwh FP_XS "$sql"
